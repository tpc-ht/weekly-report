"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[866],{50798:function(We,Y,s){s.r(Y),s.d(Y,{default:function(){return fe}});var $=s(97857),j=s.n($),_=s(5574),Z=s.n(_),ee=s(68400),M=s.n(ee),V=s(50096),r=s(85893),O,te=(0,V.kc)(function(y,d){var c=y.css,v=y.prefixCls,g=d.width;return{container:c(O||(O=M()([`
      & .`,"-form-item .",`-form-item-label {
        width: `,`px;
      }
    `])),v,v,g)}}),re=function(y){var d=y.children,c=y.width,v=c===void 0?120:c,g=te({width:v}),T=g.styles,b=g.cx,P=g.theme;return(0,r.jsx)("div",{className:T.container,children:d})},A=s(23323),U=s(2453),z=s(14271),ae=s(71230),W=s(15746),k=s(18370),le=s(78957),G=s(14726),ne=s(27484),I=s.n(ne),oe=s(12823),ie=s.n(oe),S=s(67294),H=s(87187),ue=[{title:"\u5E8F\u53F7",dataIndex:"key",rowScope:"row",width:60,render:function(d,c,v){return v+1}},{dataIndex:"project",title:"\u9879\u76EE\u540D\u79F0",width:80},{title:"\u8BA1\u5212\u7C7B\u578B",width:80,dataIndex:"planType"},{title:"\u4EFB\u52A1\u7C7B\u578B",width:80,dataIndex:"taskType"},{dataIndex:"module",width:120,title:"\u529F\u80FD\u6A21\u5757"},{dataIndex:"workContent",width:300,title:"\u5DE5\u4F5C\u5185\u5BB9",render:function(d){return(0,r.jsx)("div",{children:d.split(`
`).map(function(c){return(0,r.jsx)("div",{children:c})})})}},{dataIndex:"priority",width:60,title:"\u4F18\u5148\u7EA7"},{dataIndex:"difficulty",width:60,title:"\u96BE\u5EA6"},{dataIndex:"progress",width:60,title:"\u8FDB\u5EA6"},{dataIndex:"state",width:120,title:"\u4EFB\u52A1\u72B6\u6001"},{dataIndex:"startDate",width:120,title:"\u8BA1\u5212\u5F00\u59CB\u65E5\u671F"},{dataIndex:"endDate",width:120,title:"\u8BA1\u5212\u7ED3\u675F\u65E5\u671F"},{dataIndex:"nextLeading",width:120,title:"\u4E0B\u9636\u6BB5\u8D1F\u8D23\u4EBA"},{dataIndex:"reason",width:120,title:"\u672A\u5B8C\u6210\u539F\u56E0\u5206\u6790"},{dataIndex:"leading",width:80,title:"\u8D1F\u8D23\u4EBA"}],de=function(y){var d=y.data,c=d===void 0?[]:d;return(0,r.jsx)(H.Z,{rowKey:"key",size:"small",bordered:!0,scroll:{x:1600},columns:ue,dataSource:c})},se=[{title:"\u5E8F\u53F7",dataIndex:"key",width:60,render:function(d,c,v){return v+1}},{dataIndex:"project",title:"\u9879\u76EE\u540D\u79F0",width:80},{title:"\u4EFB\u52A1\u7C7B\u578B",width:80,dataIndex:"taskType"},{dataIndex:"module",width:80,title:"\u529F\u80FD\u6A21\u5757"},{dataIndex:"workContent",width:300,title:"\u5DE5\u4F5C\u5185\u5BB9",render:function(d){return(0,r.jsx)("div",{children:d.split(`
`).map(function(c){return(0,r.jsx)("div",{children:c})})})}},{dataIndex:"priority",width:60,title:"\u4F18\u5148\u7EA7"},{dataIndex:"difficulty",width:60,title:"\u96BE\u5EA6"},{dataIndex:"progress",width:120,title:"\u8BA1\u5212\u5B8C\u6210\u8FDB\u5EA6"},{dataIndex:"state",width:120,title:"\u8BA1\u5212\u6D4B\u8BD5\u72B6\u6001"},{dataIndex:"completionDate",width:120,title:"\u8BA1\u5212\u5B8C\u6210\u65E5\u671F"},{dataIndex:"note",width:80,title:"\u8865\u5145\u8BF4\u660E"},{dataIndex:"leading",width:80,title:"\u8D23\u4EFB\u4EBA"}],ce=function(y){var d=y.data,c=d===void 0?[]:d;return(0,r.jsx)(H.Z,{rowKey:"key",size:"small",bordered:!0,scroll:{x:1300},columns:se,dataSource:c})},me=[{header:"",key:"",width:2},{key:"index",width:5,style:{alignment:{horizontal:"center"}}},{key:"orgName",width:12,style:{alignment:{horizontal:"center"}}},{key:"planType",width:10,style:{alignment:{horizontal:"center"}}},{key:"taskType",width:10,style:{alignment:{horizontal:"center"}}},{key:"module",width:15,style:{alignment:{horizontal:"center"}}},{key:"content",width:50},{key:"priority",width:10,style:{alignment:{horizontal:"center"}}},{key:"difficulty",width:10,style:{alignment:{horizontal:"center"}}},{key:"progress",width:12,style:{alignment:{horizontal:"center"}}},{key:"state",width:15,style:{alignment:{horizontal:"center"}}},{key:"startDate",width:12,style:{alignment:{horizontal:"center"}}},{key:"endDate",width:12,style:{alignment:{horizontal:"center"}}},{key:"nextLeader",width:12,style:{alignment:{horizontal:"center"}}},{key:"note",width:15,style:{alignment:{horizontal:"center"}}},{key:"leader",width:10,style:{alignment:{horizontal:"center"}}}],ve=["B","C","D","E","F","G","H","I","J","K","L","M","N","O","P"],Pe=function(d){},J=function(d,c){var v=d.split(".")[1].trim().split(" ").filter(function(T){return!!T}),g={project:c,key:c,module:"",context:"",isUse:!1};return v.length===2?(g.key="".concat(c,"-").concat(v[0]),g.module=v[0],g.context=v[1]):v.length===3&&(g.key="".concat(v[0],"-").concat(v[1]),g.project=v[0],g.module=v[1],g.context=v[2]),g},ye=function(d){return d?I()(d).isValid():!1},K,he=(0,V.kc)(function(y){var d=y.css;return{main:d(K||(K=M()([`
      padding: 0 20px 20px;
    `])))}}),fe=function(){var y=A.Z.useForm(),d=Z()(y,1),c=d[0],v=he(),g=v.styles,T=(0,S.useRef)(""),b=(0,S.useState)([]),P=Z()(b,2),w=P[0],ge=P[1],pe=(0,S.useState)(""),Q=Z()(pe,2),X=Q[0],xe=Q[1],Ce=(0,S.useState)(""),L=Z()(Ce,2),Fe=L[0],je=L[1],Be=(0,S.useState)([]),q=Z()(Be,2),N=q[0],De=q[1];(0,S.useEffect)(function(){try{var x=localStorage.getItem("weekReport");x&&c.setFieldsValue(JSON.parse(x))}catch(e){}},[]);var Ee=function(e){try{var a=e.currentWeekReport.split(`
`),t=e.project,l={},n=function(f,D){return I()(D).unix()>I()(f).unix()?D:f},u="",m="";a.forEach(function(B,f){var D=B.trim();if(D&&!ye(D)){var p=J(D,t);l[p.key]?(l[p.key].project=p.project,l[p.key].module=p.module,l[p.key].content+=p.context+`
`,l[p.key].endDate=n(l[p.key].endDate,u)):l[p.key]={project:p.project,module:p.module,content:p.context+`
`,startDate:u,endDate:u}}else if(u=I()(D).format("YYYY-MM-DD"),f===0){var R=I()(u).format("YYYY.MM.DD");T.current+=R,m+="".concat(I()(D).format("YYYY\u5E74MM\u6708"),"\u5DE5\u4F5C\u5468\u62A5\uFF1A").concat(R)}});var h=I()(u).format("YYYY.MM.DD");T.current+="-".concat(h),m+="-".concat(h,"      "),m+="\u90E8\u95E8\uFF1A".concat(e.department,"      \u5236\u8868\u4EBA\uFF1A").concat(e.leading),xe(m);for(var o=Object.keys(l),i=[],C=0;C<o.length;C++){var E=o[C],F=l[E];i.push({key:E,project:F.project,planType:"\u8BA1\u5212\u5185",taskType:"\u9700\u6C42",module:F.module,workContent:F.content,priority:"\u9AD8",difficulty:"B",progress:"100%",state:"\u5F00\u53D1\u5B8C\u6210\uFF0C\u63D0\u6D4B",startDate:F.startDate,endDate:F.endDate,nextLeading:"\u6D4B\u8BD5",reason:"",leading:e.leading})}ge(i)}catch(B){U.ZP.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u672C\u5468\u65E5\u62A5\u683C\u5F0F")}},Ae=function(e){try{var a=e.nextWeekReport.split(`
`),t=e.project,l={},n="",u="";a.forEach(function(F){var B=F.trim();if(B)if(!n)n=B,u=I()(B.split("-")[1]).format("YYYY-MM-DD");else{var f=J(B,t);l[f.key]?(l[f.key].project=f.project,l[f.key].module=f.module,l[f.key].content+=f.context+`
`):l[f.key]={project:f.project,module:f.module,content:f.context+`
`,startDate:"",endDate:u}}});var m=" \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212\uFF1A".concat(n);je(m);for(var h=Object.keys(l),o=[],i=0;i<h.length;i++){var C=h[i],E=l[C];o.push({key:C,project:E.project,taskType:"\u9700\u6C42",module:E.module,workContent:E.content,priority:"\u9AD8",difficulty:"B",progress:"100%",state:"\u5F00\u53D1\u5B8C\u6210\uFF0C\u63D0\u6D4B",completionDate:E.endDate,note:"",leading:e.leading})}De(o),console.log("ls-next",o)}catch(F){console.log("error",F),U.ZP.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u4E0B\u5468\u8BA1\u5212\u683C\u5F0F")}},Ie=function(e){localStorage.setItem("weekReport",JSON.stringify(e)),Ee(e),Ae(e)},Te=function(e,a){var t={font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:10},alignment:{vertical:"middle",wrapText:!0},border:{top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}},l=/B\d+/,n=/P\d+/,u=/N\d+/;e.eachRow(function(m,h){m.eachCell(function(o){if(ve.includes(o.address[0])){o.style.font=j()(j()({},t.font),o.style.font),o.style.alignment=j()(j()({},t.alignment),o.style.alignment);var i=j()(j()({},t.border),o.style.border);l.test(o.address)&&(i=j()(j()({},i),{},{left:{style:"medium"}})),n.test(o.address)&&(i=j()(j()({},i),{},{right:{style:"medium"}})),u.test(o.address)&&h>=a&&(i=j()(j()({},i),{},{right:{style:"medium"}})),o.style.border=i}})})},ke=function(e){e.mergeCells("B2:P2");var a=e.getCell("B2:P2");a.value="\u7814\u53D1\u90E8\u5DE5\u4F5C\u5468\u62A5",a.font={size:18,bold:!0},a.alignment={vertical:"middle",horizontal:"center"},a.border={top:{style:"medium"}},e.mergeCells("B3:P3");var t=e.getCell("B3:P3");t.value=X,t.font={bold:!0},t.alignment={vertical:"middle",horizontal:"left"}},Se=function(e){e.columns=me,e.addRow(["","\u5E8F\u53F7","\u9879\u76EE\u540D\u79F0","\u8BA1\u5212\u7C7B\u578B","\u4EFB\u52A1\u7C7B\u578B","\u529F\u80FD\u6A21\u5757","\u5DE5\u4F5C\u5185\u5BB9","\u4F18\u5148\u7EA7","\u96BE\u5EA6","\u5B8C\u6210\u8FDB\u5EA6","\u4EFB\u52A1\u72B6\u6001","\u8BA1\u5212\u5F00\u59CB\u65E5\u671F","\u8BA1\u5212\u7ED3\u675F\u65E5\u671F","\u4E0B\u9636\u6BB5\u8D1F\u8D23\u4EBA","\u672A\u5B8C\u6210\u539F\u56E0\u5206\u6790","\u8D1F\u8D23\u4EBA"],"A10");for(var a=0;a<w.length;a++){var t=w[a],l=t.key,n=t.project,u=t.planType,m=t.taskType,h=t.module,o=t.workContent,i=t.priority,C=t.difficulty,E=t.progress,F=t.state,B=t.startDate,f=t.endDate,D=t.nextLeading,p=t.reason,R=t.leading;e.addRow(["",a+1,n,u,m,h,o.trim(),i,C,E,F,B,f,D,p,R])}},Ze=function(e,a){var t="B".concat(a,":C").concat(a),l="D".concat(a,":P").concat(a);e.mergeCells(t);var n=e.getCell(t);n.value="\u5DE5\u4F5C\u603B\u7ED3\uFF08\u5FC5\u586B\uFF09\uFF1A",e.mergeCells(l);var u=e.getCell(l);u.value="\u6309\u8BA1\u5212\u8FDB\u884C",u.style.alignment={vertical:"middle",horizontal:"center"};var m=a+1,h="B".concat(m,":C").concat(m),o="D".concat(m,":P").concat(m);e.mergeCells(h);var i=e.getCell(h);i.value="\u98CE\u9669\u53CA\u5EFA\u8BAE",i.style.border={bottom:{style:"medium"}},e.mergeCells(o);var C=e.getCell(o);C.style.alignment={vertical:"middle",horizontal:"center"},C.style.border={bottom:{style:"medium"}}},ze=function(e,a){e.mergeCells("B".concat(a,":N").concat(a));var t=e.getCell("B".concat(a,":N").concat(a));t.value=" \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212\uFF1A24.07.08-24.07.12",t.font={bold:!0},t.alignment={vertical:"middle",horizontal:"left"},t.border={top:{style:"medium"}}},we=function(e,a){e.addRow(["","\u5E8F\u53F7","\u9879\u76EE\u540D\u79F0","\u4EFB\u52A1\u7C7B\u578B","\u529F\u80FD\u6A21\u5757","\u529F\u80FD\u6A21\u5757","\u5DE5\u4F5C\u5185\u5BB9","\u4F18\u5148\u7EA7","\u96BE\u5EA6","\u8BA1\u5212\u5B8C\u6210\u8FDB\u5EA6","\u8BA1\u5212\u6D4B\u8BD5\u72B6\u6001","\u8BA1\u5212\u5B8C\u6210\u65E5\u671F","\u8865\u5145\u8BF4\u660E","\u8D23\u4EFB\u4EBA"]),e.mergeCells("E".concat(a,":F").concat(a));for(var t=a,l=0;l<N.length;l++){var n=N[l],u=n.project,m=n.taskType,h=n.module,o=n.workContent,i=n.priority,C=n.difficulty,E=n.progress,F=n.state,B=n.completionDate,f=n.note,D=n.leading;t+=1,e.addRow(["",l+1,u,m,h,h,o.trim(),i,C,E,F,B,f,D]),e.mergeCells("E".concat(t,":F").concat(t))}},Ne=function(e,a){var t="B".concat(a,":C").concat(a),l="D".concat(a,":N").concat(a);e.mergeCells(t);var n=e.getCell(t);n.value="\u98CE\u9669\u95EE\u9898",e.mergeCells(l);var u=a+1,m="B".concat(u,":C").concat(u),h="D".concat(u,":N").concat(u);e.mergeCells(m);var o=e.getCell(m);o.value="\u6C9F\u901A\u534F\u8C03",o.style.border={bottom:{style:"medium"}},e.mergeCells(h);var i=e.getCell(h);i.style.alignment={vertical:"middle",horizontal:"center"},i.style.border={bottom:{style:"medium"}}},Re=function(){var e=c.getFieldsValue(),a=new(ie()).Workbook,t=a.addWorksheet("sheet1");t.addRow([]),ke(t),Se(t);var l=5+w.length;Ze(t,l);var n=l+3;ze(t,n);var u=n+1;we(t,u);var m=u+N.length+1;Ne(t,m),Te(t,n),a.xlsx.writeBuffer().then(function(h){var o=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");i.href=URL.createObjectURL(o),i.download="".concat(e.department?e.department+"_":"").concat(e.leading?e.leading+"_":"").concat(T.current?T.current+"_":"","\u5DE5\u4F5C\u5468\u62A5.xlsx"),i.click(),URL.revokeObjectURL(i.href)})};return(0,r.jsxs)("div",{className:g.main,children:[(0,r.jsx)(z.Z.Title,{level:3,style:{textAlign:"center"},children:"\u5468\u62A5\u751F\u6210\u5DE5\u5177"}),(0,r.jsx)(re,{children:(0,r.jsxs)(A.Z,{onFinish:Ie,form:c,autoComplete:"off",initialValues:{project:"crm",department:"\u524D\u7AEF\u90E8",summary:"\u8BA1\u5212\u8FDB\u884C"},children:[(0,r.jsxs)(ae.Z,{gutter:16,children:[(0,r.jsx)(W.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u9ED8\u8BA4\u9879\u76EE\u540D\u79F0",rules:[{required:!0}],name:"project",children:(0,r.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165"})})}),(0,r.jsx)(W.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u90E8\u95E8",rules:[{required:!0}],name:"department",children:(0,r.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165"})})}),(0,r.jsx)(W.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u8D1F\u8D23\u4EBA",rules:[{required:!0}],name:"leading",children:(0,r.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,r.jsx)(A.Z.Item,{label:"\u5DE5\u4F5C\u603B\u7ED3",rules:[{required:!0}],name:"summary",children:(0,r.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(A.Z.Item,{label:"\u672C\u5468\u65E5\u62A5",rules:[{required:!0}],name:"currentWeekReport",tooltip:(0,r.jsxs)("div",{children:["\u683C\u5F0F\uFF1A",(0,r.jsx)("div",{children:"2024-01-01"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"}),(0,r.jsx)("div",{children:"2024-01-02"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"})]}),children:(0,r.jsx)(k.Z.TextArea,{rows:6,placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(A.Z.Item,{label:"\u4E0B\u5468\u8BA1\u5212",rules:[{required:!0}],name:"nextWeekReport",tooltip:(0,r.jsxs)("div",{children:["\u683C\u5F0F\uFF1A",(0,r.jsx)("div",{children:"2024.07.08-2024.07.12"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"})]}),children:(0,r.jsx)(k.Z.TextArea,{rows:6,placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsxs)(le.Z,{style:{width:"100%",justifyContent:"flex-end"},children:[(0,r.jsx)(G.ZP,{type:"primary",style:{margin:"0 auto"},htmlType:"submit",children:"\u89E3\u6790"}),(0,r.jsx)(G.ZP,{disabled:!(w.length&&N.length),style:{margin:"0 auto"},onClick:Re,children:"\u5BFC\u51FA"})]})]})}),(0,r.jsx)(z.Z.Title,{level:4,children:"\u672C\u5468\u5468\u62A5\u9884\u89C8"}),(0,r.jsx)(z.Z.Paragraph,{children:X}),(0,r.jsx)(de,{data:w}),(0,r.jsx)(z.Z.Title,{level:4,children:"\u4E0B\u5468\u62A5\u9884\u89C8"}),(0,r.jsx)(z.Z.Paragraph,{children:Fe}),(0,r.jsx)(ce,{data:N})]})}}}]);
