"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[866],{23076:function($,g,n){n.r(g);var C=n(48305),f=n.n(C),m=n(35857),j=n(78522),x=n(11168),T=n(71039),O=n(94149),L=n(8871),R=n(5726),P=n.n(R),U=n(75801),w=n.n(U),p=n(93236),r=n(62086);g.default=function(){var I=m.Z.useForm(),W=f()(I,1),F=W[0],k=(0,p.useState)(""),M=f()(k,2),z=M[0],K=M[1],Z=(0,p.useState)({}),B=f()(Z,2),c=B[0],S=B[1],b=function(o,l){console.log("str",o);var t=o.split(".")[1].trim().split(" "),e={project:l,menu:"",context:"",isUse:!1};return t.length===2?(e.menu=t[0],e.context=t[1]):t.length===3&&(e.project=t[0],e.menu=t[1],e.context=t[2]),e},N=function(o){try{var l=o.content.split(`
`),t="\u5546\u7BA1",e={},s=function(i){if(!e)return!1;var a=/^\d\d\d\d[-](\d{1,2})[-](\d{1,2})$/;return a.test(i)},u=function(i,a){return P()(a).unix()>P()(i).unix()?a:i},h="";l.forEach(function(E){var i=E.trim();if(i&&!s(i)){var a=b(i,t);a.menu&&(e[a.menu]?(e[a.menu].content+=a.context+`
`,e[a.menu].endDate=u(e[a.menu].endDate,h)):e[a.menu]={content:a.context+`
`,startDate:h,endDate:h})}else h=i});for(var y=Object.keys(e),d="",D=0;D<y.length;D++){var v=y[D];d+="".concat(v," ").concat(e[v].startDate," - ").concat(e[v].endDate,`
`).concat(e[v].content,`
`)}S(e),K(d.trim())}catch(E){j.ZP.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u683C\u5F0F")}},A=function(o,l){var t=o.getRow(l);t.font={name:"\u5FAE\u8F6F\u96C5\u9ED1",size:10},t.alignment={vertical:"middle"},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}},X=function(){var o=new(w()).Workbook,l=o.addWorksheet("sheet1");l.columns=[{header:"\u5E8F\u53F7",key:"index",width:5,style:{alignment:{horizontal:"center"}}},{header:"\u9879\u76EE\u540D\u79F0",key:"orgName",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u8BA1\u5212\u7C7B\u578B",key:"planType",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u4EFB\u52A1\u7C7B\u578B",key:"taskType",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u529F\u80FD\u6A21\u5757",key:"module",width:15,style:{alignment:{horizontal:"center"}}},{header:"\u5DE5\u4F5C\u5185\u5BB9",key:"content",width:50},{header:"\u4F18\u5148\u7EA7",key:"priority",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u96BE\u5EA6",key:"difficulty",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u5B8C\u6210\u8FDB\u5EA6",key:"progress",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u4EFB\u52A1\u72B6\u6001",key:"state",width:15,style:{alignment:{horizontal:"center"}}},{header:"\u8BA1\u5212\u5F00\u59CB\u65E5\u671F",key:"startDate",width:12,style:{alignment:{horizontal:"center"}}},{header:"\u8BA1\u5212\u7ED3\u675F\u65E5\u671F",key:"endDate",width:12,style:{alignment:{horizontal:"center"}}},{header:"\u4E0B\u9636\u6BB5\u8D1F\u8D23\u4EBA",key:"nextLeader",width:10,style:{alignment:{horizontal:"center"}}},{header:"\u672A\u5B8C\u6210\u539F\u56E0\u5206\u6790",key:"note",width:15,style:{alignment:{horizontal:"center"}}},{header:"\u8D1F\u8D23\u4EBA",key:"leader",width:10,style:{alignment:{horizontal:"center"}}}];for(var t=Object.keys(c),e=F.getFieldValue("orgName"),s=0;s<t.length;s++){var u=t[s];A(l,s+1),l.addRow({index:s+1,orgName:e,planType:"\u8BA1\u5212\u5185",taskType:"\u9700\u6C42",module:u,content:c[u].content.trim(),priority:"\u9AD8",difficulty:"B",progress:"100%",state:"\u5F00\u53D1\u5B8C\u6210\uFF0C\u63D0\u6D4B",startDate:c[u].startDate.trim(),endDate:c[u].endDate.trim(),nextLeader:"\u6D4B\u8BD5",note:"",leader:"\u5510***"})}A(l,t.length+1),o.xlsx.writeBuffer().then(function(h){var y=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=document.createElement("a");d.href=URL.createObjectURL(y),d.download="\u5468\u62A5.xlsx",d.click(),URL.revokeObjectURL(d.href)})};return(0,r.jsxs)(m.Z,{onFinish:N,form:F,layout:"vertical",name:"dynamic_form_complex",style:{maxWidth:600,margin:"0 auto"},autoComplete:"off",initialValues:{items:[{}]},children:[(0,r.jsx)(m.Z.Item,{label:"\u9879\u76EE\u540D\u79F0",name:"orgName",children:(0,r.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(m.Z.Item,{label:"\u65E5\u62A5\u5185\u5BB9",rules:[{required:!0}],name:"content",tooltip:(0,r.jsxs)("div",{children:["\u683C\u5F0F\uFF1A",(0,r.jsx)("div",{children:"2024-04-01"}),(0,r.jsx)("div",{children:"1. \u4EBA\u5458\u7BA1\u7406 \u529F\u80FD\u5F00\u53D1"}),(0,r.jsx)("div",{children:"2. \u89D2\u8272\u7BA1\u7406 XXXX\u5F00\u53D1"})]}),children:(0,r.jsx)(x.Z.TextArea,{rows:6,placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsxs)(T.Z,{style:{width:"100%",justifyContent:"flex-end"},children:[(0,r.jsx)(O.ZP,{type:"primary",style:{margin:"0 auto"},htmlType:"submit",children:"\u89E3\u6790"}),(0,r.jsx)(O.ZP,{disabled:!Object.keys(c).length,style:{margin:"0 auto"},onClick:X,children:"\u5BFC\u51FA"})]}),(0,r.jsx)(m.Z.Item,{label:"\u7ED3\u679C",noStyle:!0,shouldUpdate:!0,style:{minHeight:300},children:function(){return(0,r.jsx)(L.Z,{children:(0,r.jsx)("pre",{style:{minHeight:300},children:z})})}})]})}}}]);
