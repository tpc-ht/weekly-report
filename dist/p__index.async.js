"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[866],{50798:function(Pe,W,s){s.r(W),s.d(W,{default:function(){return ge}});var _=s(97857),j=s.n(_),ee=s(5574),k=s.n(ee),te=s(68400),M=s.n(te),V=s(50096),r=s(85893),O,re=(0,V.kc)(function(h,u){var c=h.css,v=h.prefixCls,g=u.width;return{container:c(O||(O=M()([`
      & .`,"-form-item .",`-form-item-label {
        width: `,`px;
      }
    `])),v,v,g)}}),ae=function(h){var u=h.children,c=h.width,v=c===void 0?120:c,g=re({width:v}),T=g.styles,b=g.cx,P=g.theme;return(0,r.jsx)("div",{className:T.container,children:u})},A=s(23323),U=s(2453),z=s(14271),le=s(71230),R=s(15746),S=s(18370),ne=s(78957),G=s(14726),oe=s(27484),I=s.n(oe),ie=s(12823),de=s.n(ie),Z=s(67294),H=s(87187),ue=[{title:"\u5E8F\u53F7",dataIndex:"key",rowScope:"row",width:60,render:function(u,c,v){return v+1}},{dataIndex:"project",title:"\u9879\u76EE\u540D\u79F0",width:80},{title:"\u8BA1\u5212\u7C7B\u578B",width:80,dataIndex:"planType"},{title:"\u4EFB\u52A1\u7C7B\u578B",width:80,dataIndex:"taskType"},{dataIndex:"module",width:120,title:"\u529F\u80FD\u6A21\u5757"},{dataIndex:"workContent",width:300,title:"\u5DE5\u4F5C\u5185\u5BB9",render:function(u){return(0,r.jsx)("div",{children:u.split(`
`).map(function(c){return(0,r.jsx)("div",{children:c})})})}},{dataIndex:"priority",width:60,title:"\u4F18\u5148\u7EA7"},{dataIndex:"difficulty",width:60,title:"\u96BE\u5EA6"},{dataIndex:"progress",width:60,title:"\u8FDB\u5EA6"},{dataIndex:"state",width:120,title:"\u4EFB\u52A1\u72B6\u6001"},{dataIndex:"endDate",width:120,title:"\u8BA1\u5212\u5B8C\u6210\u65E5\u671F"},{dataIndex:"endDate",width:120,title:"\u5B9E\u9645\u5B8C\u6210\u65E5\u671F"},{dataIndex:"nextLeading",width:120,title:"\u4E0B\u9636\u6BB5\u8D1F\u8D23\u4EBA"},{dataIndex:"reason",width:120,title:"\u672A\u5B8C\u6210\u539F\u56E0\u5206\u6790"},{dataIndex:"leading",width:80,title:"\u8D1F\u8D23\u4EBA"}],se=function(h){var u=h.data,c=u===void 0?[]:u;return(0,r.jsx)(H.Z,{rowKey:"key",size:"small",bordered:!0,scroll:{x:1600},columns:ue,dataSource:c})},ce=[{title:"\u5E8F\u53F7",dataIndex:"key",width:60,render:function(u,c,v){return v+1}},{dataIndex:"project",title:"\u9879\u76EE\u540D\u79F0",width:80},{title:"\u4EFB\u52A1\u7C7B\u578B",width:80,dataIndex:"taskType"},{dataIndex:"module",width:80,title:"\u529F\u80FD\u6A21\u5757"},{dataIndex:"workContent",width:300,title:"\u5DE5\u4F5C\u5185\u5BB9",render:function(u){return(0,r.jsx)("div",{children:u.split(`
`).map(function(c){return(0,r.jsx)("div",{children:c})})})}},{dataIndex:"priority",width:60,title:"\u4F18\u5148\u7EA7"},{dataIndex:"difficulty",width:60,title:"\u96BE\u5EA6"},{dataIndex:"progress",width:120,title:"\u8BA1\u5212\u5B8C\u6210\u8FDB\u5EA6"},{dataIndex:"state",width:120,title:"\u8BA1\u5212\u6D4B\u8BD5\u72B6\u6001"},{dataIndex:"completionDate",width:120,title:"\u8BA1\u5212\u5B8C\u6210\u65E5\u671F"},{dataIndex:"note",width:80,title:"\u8865\u5145\u8BF4\u660E"},{dataIndex:"leading",width:80,title:"\u8D23\u4EFB\u4EBA"}],me=function(h){var u=h.data,c=u===void 0?[]:u;return(0,r.jsx)(H.Z,{rowKey:"key",size:"small",bordered:!0,scroll:{x:1300},columns:ce,dataSource:c})},ve=[{header:"",key:"",width:2},{key:"index",width:5,style:{alignment:{horizontal:"center"}}},{key:"orgName",width:12,style:{alignment:{horizontal:"center"}}},{key:"planType",width:10,style:{alignment:{horizontal:"center"}}},{key:"taskType",width:10,style:{alignment:{horizontal:"center"}}},{key:"module",width:15,style:{alignment:{horizontal:"center"}}},{key:"content",width:50},{key:"priority",width:10,style:{alignment:{horizontal:"center"}}},{key:"difficulty",width:10,style:{alignment:{horizontal:"center"}}},{key:"progress",width:12,style:{alignment:{horizontal:"center"}}},{key:"state",width:15,style:{alignment:{horizontal:"center"}}},{key:"startDate",width:12,style:{alignment:{horizontal:"center"}}},{key:"endDate",width:12,style:{alignment:{horizontal:"center"}}},{key:"nextLeader",width:12,style:{alignment:{horizontal:"center"}}},{key:"note",width:15,style:{alignment:{horizontal:"center"}}},{key:"leader",width:10,style:{alignment:{horizontal:"center"}}}],ye=["B","C","D","E","F","G","H","I","J","K","L","M","N","O","P"],Ye=function(u){},J=function(u,c){var v=u.split(".")[1].trim().split(" ").filter(function(T){return!!T}),g={project:c,key:c,module:"",context:"",isUse:!1};return v.length===2?(g.key="".concat(c,"-").concat(v[0]),g.module=v[0],g.context=v[1]):v.length===3&&(g.key="".concat(v[0],"-").concat(v[1]),g.project=v[0],g.module=v[1],g.context=v[2]),g},he=function(u){return u?I()(u).isValid():!1},K,fe=(0,V.kc)(function(h){var u=h.css;return{main:u(K||(K=M()([`
      padding: 0 20px 20px;
    `])))}}),ge=function(){var h=A.Z.useForm(),u=k()(h,1),c=u[0],v=fe(),g=v.styles,T=(0,Z.useRef)(""),b=(0,Z.useState)([]),P=k()(b,2),w=P[0],pe=P[1],xe=(0,Z.useState)(""),Q=k()(xe,2),X=Q[0],Ce=Q[1],Fe=(0,Z.useState)(""),L=k()(Fe,2),q=L[0],je=L[1],De=(0,Z.useState)([]),$=k()(De,2),N=$[0],Be=$[1];(0,Z.useEffect)(function(){try{var x=localStorage.getItem("weekReport");x&&c.setFieldsValue(JSON.parse(x))}catch(e){}},[]);var Ee=function(e){try{var a=e.currentWeekReport.split(`
`),t=e.project,l={},n=function(y,D){return I()(D).unix()>I()(y).unix()?D:y},d="",m="";a.forEach(function(E,y){var D=E.trim();if(D&&!he(D)){var p=J(D,t);l[p.key]?(l[p.key].project=p.project,l[p.key].module=p.module,l[p.key].content+=p.context+`
`,l[p.key].endDate=n(l[p.key].endDate,d)):l[p.key]={project:p.project,module:p.module,content:p.context+`
`,startDate:d,endDate:d}}else if(d=I()(D).format("YYYY-MM-DD"),y===0){var Y=I()(d).format("YYYY.MM.DD");m+="".concat(I()(D).format("YYYY\u5E74MM\u6708"),"\u5DE5\u4F5C\u5468\u62A5\uFF1A").concat(Y)}});var f=I()(d).format("YYYY.MM.DD");m+="-".concat(f,"      "),m+="\u90E8\u95E8\uFF1A".concat(e.department,"      \u5236\u8868\u4EBA\uFF1A").concat(e.leading),Ce(m);for(var o=Object.keys(l),i=[],C=0;C<o.length;C++){var B=o[C],F=l[B];i.push({key:B,project:F.project,planType:"\u8BA1\u5212\u5185",taskType:"\u9700\u6C42",module:F.module,workContent:F.content,priority:"\u9AD8",difficulty:"B",progress:"100%",state:"\u5F00\u53D1\u5B8C\u6210\uFF0C\u63D0\u6D4B",startDate:F.startDate,endDate:F.endDate,nextLeading:"\u6D4B\u8BD5",reason:"",leading:e.leading})}pe(i)}catch(E){U.ZP.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u672C\u5468\u65E5\u62A5\u683C\u5F0F")}},Ae=function(e){try{var a=e.nextWeekReport.split(`
`),t=e.project,l={},n="",d="";a.forEach(function(F){var E=F.trim();if(E)if(!n)n=E,d=I()(E.split("-")[1]).format("YYYY-MM-DD");else{var y=J(E,t);l[y.key]?(l[y.key].project=y.project,l[y.key].module=y.module,l[y.key].content+=y.context+`
`):l[y.key]={project:y.project,module:y.module,content:y.context+`
`,startDate:"",endDate:d}}});var m=" \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212\uFF1A".concat(n);T.current=n,je(m);for(var f=Object.keys(l),o=[],i=0;i<f.length;i++){var C=f[i],B=l[C];o.push({key:C,project:B.project,taskType:"\u9700\u6C42",module:B.module,workContent:B.content,priority:"\u9AD8",difficulty:"B",progress:"100%",state:"\u5F00\u53D1\u5B8C\u6210\uFF0C\u63D0\u6D4B",completionDate:B.endDate,note:"",leading:e.leading})}Be(o),console.log("ls-next",o)}catch(F){console.log("error",F),U.ZP.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u4E0B\u5468\u8BA1\u5212\u683C\u5F0F")}},Ie=function(e){localStorage.setItem("weekReport",JSON.stringify(e)),Ee(e),Ae(e)},Te=function(e,a){var t={font:{name:"\u5FAE\u8F6F\u96C5\u9ED1",size:10},alignment:{vertical:"middle",wrapText:!0},border:{top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}},l=/B\d+/,n=/P\d+/,d=/N\d+/;e.eachRow(function(m,f){m.eachCell(function(o){if(ye.includes(o.address[0])){o.style.font=j()(j()({},t.font),o.style.font),o.style.alignment=j()(j()({},t.alignment),o.style.alignment);var i=j()(j()({},t.border),o.style.border);l.test(o.address)&&(i=j()(j()({},i),{},{left:{style:"medium"}})),n.test(o.address)&&(i=j()(j()({},i),{},{right:{style:"medium"}})),d.test(o.address)&&f>=a&&(i=j()(j()({},i),{},{right:{style:"medium"}})),o.style.border=i}})})},Se=function(e){e.mergeCells("B2:P2");var a=e.getCell("B2:P2");a.value="\u7814\u53D1\u90E8\u5DE5\u4F5C\u5468\u62A5",a.font={size:18,bold:!0},a.alignment={vertical:"middle",horizontal:"center"},a.border={top:{style:"medium"}},e.mergeCells("B3:P3");var t=e.getCell("B3:P3");t.value=X,t.font={bold:!0},t.alignment={vertical:"middle",horizontal:"left"}},Ze=function(e){e.columns=ve,e.addRow(["","\u5E8F\u53F7","\u9879\u76EE\u540D\u79F0","\u8BA1\u5212\u7C7B\u578B","\u4EFB\u52A1\u7C7B\u578B","\u529F\u80FD\u6A21\u5757","\u5DE5\u4F5C\u5185\u5BB9","\u4F18\u5148\u7EA7","\u96BE\u5EA6","\u5B8C\u6210\u8FDB\u5EA6","\u4EFB\u52A1\u72B6\u6001","\u8BA1\u5212\u5B8C\u6210\u65E5\u671F","\u5B9E\u9645\u5B8C\u6210\u65E5\u671F","\u4E0B\u9636\u6BB5\u8D1F\u8D23\u4EBA","\u672A\u5B8C\u6210\u539F\u56E0\u5206\u6790","\u8D1F\u8D23\u4EBA"],"A10");for(var a=0;a<w.length;a++){var t=w[a],l=t.key,n=t.project,d=t.planType,m=t.taskType,f=t.module,o=t.workContent,i=t.priority,C=t.difficulty,B=t.progress,F=t.state,E=t.startDate,y=t.endDate,D=t.nextLeading,p=t.reason,Y=t.leading;e.addRow(["",a+1,n,d,m,f,o.trim(),i,C,B,F,y,y,D,p,Y])}},ke=function(e,a){var t="B".concat(a,":C").concat(a),l="D".concat(a,":P").concat(a);e.mergeCells(t);var n=e.getCell(t);n.value="\u5DE5\u4F5C\u603B\u7ED3\uFF08\u5FC5\u586B\uFF09\uFF1A",e.mergeCells(l);var d=e.getCell(l);d.value="\u6309\u8BA1\u5212\u8FDB\u884C",d.style.alignment={vertical:"middle",horizontal:"center"};var m=a+1,f="B".concat(m,":C").concat(m),o="D".concat(m,":P").concat(m);e.mergeCells(f);var i=e.getCell(f);i.value="\u98CE\u9669\u53CA\u5EFA\u8BAE",i.style.border={bottom:{style:"medium"}},e.mergeCells(o);var C=e.getCell(o);C.style.alignment={vertical:"middle",horizontal:"center"},C.style.border={bottom:{style:"medium"}}},ze=function(e,a){e.mergeCells("B".concat(a,":N").concat(a));var t=e.getCell("B".concat(a,":N").concat(a));t.value=q,t.font={bold:!0},t.alignment={vertical:"middle",horizontal:"left"},t.border={top:{style:"medium"}}},we=function(e,a){e.addRow(["","\u5E8F\u53F7","\u9879\u76EE\u540D\u79F0","\u4EFB\u52A1\u7C7B\u578B","\u529F\u80FD\u6A21\u5757","\u529F\u80FD\u6A21\u5757","\u5DE5\u4F5C\u5185\u5BB9","\u4F18\u5148\u7EA7","\u96BE\u5EA6","\u8BA1\u5212\u5B8C\u6210\u8FDB\u5EA6","\u8BA1\u5212\u6D4B\u8BD5\u72B6\u6001","\u8BA1\u5212\u5B8C\u6210\u65E5\u671F","\u8865\u5145\u8BF4\u660E","\u8D23\u4EFB\u4EBA"]),e.mergeCells("E".concat(a,":F").concat(a));for(var t=a,l=0;l<N.length;l++){var n=N[l],d=n.project,m=n.taskType,f=n.module,o=n.workContent,i=n.priority,C=n.difficulty,B=n.progress,F=n.state,E=n.completionDate,y=n.note,D=n.leading;t+=1,e.addRow(["",l+1,d,m,f,f,o.trim(),i,C,B,F,E,y,D]),e.mergeCells("E".concat(t,":F").concat(t))}},Ne=function(e,a){var t="B".concat(a,":C").concat(a),l="D".concat(a,":N").concat(a);e.mergeCells(t);var n=e.getCell(t);n.value="\u98CE\u9669\u95EE\u9898",e.mergeCells(l);var d=a+1,m="B".concat(d,":C").concat(d),f="D".concat(d,":N").concat(d);e.mergeCells(m);var o=e.getCell(m);o.value="\u6C9F\u901A\u534F\u8C03",o.style.border={bottom:{style:"medium"}},e.mergeCells(f);var i=e.getCell(f);i.style.alignment={vertical:"middle",horizontal:"center"},i.style.border={bottom:{style:"medium"}}},Re=function(){var e=c.getFieldsValue(),a=new(de()).Workbook,t=a.addWorksheet("sheet1");t.addRow([]),Se(t),Ze(t);var l=5+w.length;ke(t,l);var n=l+3;ze(t,n);var d=n+1;we(t,d);var m=d+N.length+1;Ne(t,m),Te(t,n),a.xlsx.writeBuffer().then(function(f){var o=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");i.href=URL.createObjectURL(o),i.download="".concat(e.department?e.department+"_":"").concat(e.leading?e.leading+"_":"").concat(T.current?T.current+"_":"","\u5DE5\u4F5C\u5468\u62A5.xlsx"),i.click(),URL.revokeObjectURL(i.href)})};return(0,r.jsxs)("div",{className:g.main,children:[(0,r.jsx)(z.Z.Title,{level:3,style:{textAlign:"center"},children:"\u5468\u62A5\u751F\u6210\u5DE5\u5177"}),(0,r.jsx)(ae,{children:(0,r.jsxs)(A.Z,{onFinish:Ie,form:c,autoComplete:"off",initialValues:{project:"crm",department:"\u524D\u7AEF\u90E8",summary:"\u8BA1\u5212\u8FDB\u884C"},children:[(0,r.jsxs)(le.Z,{gutter:16,children:[(0,r.jsx)(R.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u9ED8\u8BA4\u9879\u76EE\u540D\u79F0",rules:[{required:!0}],name:"project",children:(0,r.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165"})})}),(0,r.jsx)(R.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u90E8\u95E8",rules:[{required:!0}],name:"department",children:(0,r.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165"})})}),(0,r.jsx)(R.Z,{span:8,children:(0,r.jsx)(A.Z.Item,{label:"\u8D1F\u8D23\u4EBA",rules:[{required:!0}],name:"leading",children:(0,r.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,r.jsx)(A.Z.Item,{label:"\u5DE5\u4F5C\u603B\u7ED3",rules:[{required:!0}],name:"summary",children:(0,r.jsx)(S.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(A.Z.Item,{label:"\u672C\u5468\u65E5\u62A5",rules:[{required:!0}],name:"currentWeekReport",tooltip:(0,r.jsxs)("div",{children:["\u683C\u5F0F\uFF1A",(0,r.jsx)("div",{children:"2024-01-01"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"}),(0,r.jsx)("div",{children:"2024-01-02"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"})]}),children:(0,r.jsx)(S.Z.TextArea,{rows:6,placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(A.Z.Item,{label:"\u4E0B\u5468\u8BA1\u5212",rules:[{required:!0}],name:"nextWeekReport",tooltip:(0,r.jsxs)("div",{children:["\u683C\u5F0F\uFF1A",(0,r.jsx)("div",{children:"2024.07.08-2024.07.12"}),(0,r.jsx)("div",{children:"1. [\u9879\u76EE\u540D\u79F0] \u6A21\u5757\u540D\u79F0 \u5DE5\u4F5C\u5185\u5BB9"})]}),children:(0,r.jsx)(S.Z.TextArea,{rows:6,placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsxs)(ne.Z,{style:{width:"100%",justifyContent:"flex-end"},children:[(0,r.jsx)(G.ZP,{type:"primary",style:{margin:"0 auto"},htmlType:"submit",children:"\u89E3\u6790"}),(0,r.jsx)(G.ZP,{disabled:!(w.length&&N.length),style:{margin:"0 auto"},onClick:Re,children:"\u5BFC\u51FA"})]})]})}),(0,r.jsx)(z.Z.Title,{level:4,children:"\u672C\u5468\u5468\u62A5\u9884\u89C8"}),(0,r.jsx)(z.Z.Paragraph,{children:X}),(0,r.jsx)(se,{data:w}),(0,r.jsx)(z.Z.Title,{level:4,children:"\u4E0B\u5468\u62A5\u9884\u89C8"}),(0,r.jsx)(z.Z.Paragraph,{children:q}),(0,r.jsx)(me,{data:N})]})}}}]);
